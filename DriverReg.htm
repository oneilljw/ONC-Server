 <!DOCTYPE html>
<html>
<head lang="en">
  <title>ONC Delivery Registration</title>
  <link rel="stylesheet" type="text/css" href="oncstylesheet.css">
  <link rel="stylesheet" type="text/css" href="oncdialogstylesheet.css">
  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script> 
  	var errorColor = '#FF9999';
  	
  	$( document ).ready(function()
	{
  		//set the hidden values
  		document.getElementById('year').value= new Date().getFullYear().toString();
  		
  		//update the nav bar links with token
  		document.getElementById('logoutlink').href="onchomepage";
  		document.getElementById('homelink').href="onchomepage";
  		
  		$(function() 
  		{
  		    $("form input").keypress(function (e) {
  		        if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {
  		            $('button[type=submit] .default').click();
  		            return false;
  		        } else {
  		            return true;
  		        }
  		    });
  		});
  		
  		$('html').bind('keypress', function(e)
  		{
  			if(e.keyCode == 13)
  			{
  				return false;
  			}
  		});
  		
  		//show the success dialog if driver was registered
  		var urlmode = window.location.href;
	  	if(urlmode.indexOf("registerdriver") > -1)
  			window.location=document.getElementById('registeredanchor').href;
	});
  	
	function verifyPhoneNumber(elementNum)
	{
		var phoneElement= [document.getElementById('primaryphone'), 
							document.getElementById('altphone')];
		
		var numberGood = true;
		var number= phoneElement[elementNum].value;
		
		if(number == '')
			phoneElement[elementNum].style.backgroundColor = '#FFFFFF';
		else if(number.length===12 && number.charAt(3)==='-' && number.charAt(7)==='-')
			phoneElement[elementNum].style.backgroundColor = '#FFFFFF';
		else if(number.length===12 && number.charAt(3)==='.' && number.charAt(7)==='.')
			phoneElement[elementNum].style.backgroundColor = '#FFFFFF';
		else if(number.length===10 && number.indexOf("-")===-1 && number.indexOf(".")===-1)
			phoneElement[elementNum].style.backgroundColor = '#FFFFFF';
		else
		{
			numberGood= false;
			phoneElement[elementNum].style.backgroundColor = errorColor;
		}
	
		return numberGood;
	}
	
	function verifyPhoneNumbers()
	{
		var errorMssg= "";
		
		var phoneName= ["Primary", "Alternate"];
		
		var index=0;
		while(index<phoneName.length && verifyPhoneNumber(index))
				index++;
		
		if(index < phoneName.length)	
			errorMssg= "Submission Error: " + phoneName[index] + " Phone # is invalid";	
		
		return errorMssg;	
	}
	
	function verifyRequiredFields(verifyElements, errorElement)
	{	
		var bRequiredFieldGood = true
		var index=0;
		while(index<verifyElements.length)
		{
			if(verifyElements[index].value === '')
			{
				bRequiredFieldGood = false;
				errorMssg= "Error: " + verifyElements[index].title + " is missing or invalid";
				errorElement.textContent = errorMssg;
				errorElement.style.color ='red';
				verifyElements[index].style.backgroundColor = errorColor;
				break;
			}
			else
			{
				verifyElements[index++].style.backgroundColor = '#FFFFFF';
				errorElement.textContent = '';
			}	
		}		

		return bRequiredFieldGood;	
	}
	
	function verifyZipCodes(zipElements, errorElement)
	{	
		var bRequiredFieldGood = true
		var index=0;
		while(index<zipElements.length)
		{
			var zipCode = zipElements[index].value;
			if(zipCode.length === 5 || zipCode.length === 10)
			{
				zipElements[index++].style.backgroundColor = '#FFFFFF';
				errorElement.textContent = '';
			}
			else
			{
				bRequiredFieldGood = false;
				errorMssg= "Error: " + zipElements[index].title + " is invalid";
				errorElement.textContent = errorMssg;
				errorElement.style.color ='red';
				zipElements[index].style.backgroundColor = errorColor;
				break;
			}
		}		

		return bRequiredFieldGood;	
	}
	
	function verifyEmail(emailElement, confirmemailElement)
	{
		var email = emailElement.value;
		var confirmemail = confirmemailElement.value;
		
		emailElement.style.backgroundColor = "#FFFFFF";
		confirmemailElement.style.backgroundColor = "#FFFFFF";
		
		//check to see they are formed properly
		if(email.length > 0 && email.includes('.') && email.includes('@'))
		{
			if(confirmemail.length > 0 && confirmemail.includes('.') && confirmemail.includes('@'))
			{
				if(email === confirmemail )
					return true;
				else
				{
					var elementsWithErrors = [emailElement, confirmemailElement];
					indicateError(elementsWithErrors, "does not match Confirm Email Address");
					return false;
				}
			}
			else		
			{
				var elementsWithErrors = [confirmemailElement];
				indicateError(elementsWithErrors, "is not properly formatted");
				return false;
			}
		}
		else
		{
			var elementsWithErrors = [emailElement];
			indicateError(elementsWithErrors, "is not properly formatted");
			return false;
		}	
	}
	
	function indicateError(elements, error)
	{
		var errorElement = document.getElementById('errormessage');
		var errorMssg= "Error: " + elements[0].title + " " + error;
		
		errorElement.textContent = errorMssg;
		errorElement.style.color = 'red';
		
		var index = 0;
		while(index < elements.length)
			elements[index++].style.backgroundColor = errorColor;
	}
	
	function submitRegistration()
	{
		var verifyElements= [document.getElementById('delfn'),
		                     document.getElementById('delln'),
		                     document.getElementById('delhousenum'),
		                     document.getElementById('delstreet'),
		                     document.getElementById('delcity')];
		
		var zipElements =[document.getElementById('delzipcode')];
		
		var emailElement = document.getElementById('delemail');
		var confirmemailElement = document.getElementById('confirmemail');
		
		var errorElement = document.getElementById('errormessage');
		
		if(verifyRequiredFields(verifyElements, errorElement) && 
			verifyZipCodes(zipElements, errorElement) &&
			 verifyEmail(emailElement, confirmemailElement))
		{
			//check phone numbers
			var phoneMssg= verifyPhoneNumbers();
			if(phoneMssg === '')
			{
				//submit the form, all fields are validated
				document.driverregform.submit();
			}
			else
			{
				phoneNumbersGood=false;
				errorElement.textContent=phoneMssg;
				errorElement.style.color ='red';
			}
		}
	}
	
	function onCloseDialog()
	{
		window.location=document.getElementById('closepopup').href;
	}
	
  </script>
  <style>
	#submitspan {float: right;}
	#errormessage
	{
		float: left;
		font-weight: bold;
		font-style: italic;
		color: black;
	}
	#altphonelbl, #confirmemaillbl
	{
		padding-left: 20px;
	}
	.inputline
	{
		margin-bottom: 10px;
	}
  </style>
</head>
<body>
<a href="#registereddlg" id="registeredanchor" style="visibility: hidden">Success</a>
  <div id="topbar" class="topbar">
    <img src="onclogo" height="55" width="75"/>
    <p><span id="banner">ONC Volunteer Registration Form</span><br>
	<span id="message">(Please complete and click Submit Registration To ONC)</span></p>
  </div>
   <nav>
    <ul>
	    <li id="homeli"><a id='homelink'>Home</a></li>
	</ul>
	<ul class='floatright'>
	    <li id="logoutli"><a id='logoutlink'>Logout</a></li>
	</ul>
  </nav>
  <form id='driverregform' name='driverregform' action="registerdriver" method="post">
  <input id="year" type="hidden" name="year">
  <br>
  <fieldset>
  <legend class="legend-major">Volunteer Information</legend>
  	<div class= 'inputline'>
      <label for="delfn">Name:</label>
      <input id="delfn" title="First Name" name="delFN" type="text" size="20" placeholder="First Name" required>
      <input id="delln" title="Last Name" name="delLN" type="text" size="20" placeholder="Last Name" required>
    </div>
    <div class= 'inputline'>
      <label for="primaryphone">Primary Phone:</label>
      <input id="primaryphone" title="Primary Phone #" name="primaryhone" type="text" size="18" placeholder="Primary Phone #" onchange="verifyPhoneNumber(0)" required>
      <select id="primaryphoneselect" title="Primary Phone Type" name="primaryphonetype">
		<option value="Cell">Cell</option>
		<option value="Home">Home</option>
		<option value="Work">Work</option>
	  </select>
	  <label for="altphone" id='altphonelbl'>Alternate Phone:</label>
      <input id= "altphone" title="Alternate Phone #" name="altphone" type="text" size="18" placeholder="Alternate Phone #" onchange="verifyPhoneNumber(1)">
  	  <select id="altphoneselect" title="Alternate Phone Type" name="altphonetype">
		<option value="Home">Home</option>
		<option value="Cell">Cell</option>
		<option value="Work">Work</option>
		<option value="Other">Other</option>
	 </select>
	 </div>
	<div class= 'inputline'>
	  <label for="delemail">Email:</label>
	  <input id="delemail" title="Email Address" name="delemail" type="email" size="30" placeholder="email address" autocomplete= "off">
	  <label for="confirmemail"  id='confirmemaillbl'>Confirm Email:</label>
	  <input id="confirmemail" title="Confirm Email Address" type="email" size="30" placeholder="confirm email address" autocomplete= "off">
	</div>
	<div class= 'inputline'>
	  <label for="delhousenum">Address:</label>
	  <input id="delhousenum" title="House #" name="delhousenum" type="text" size="8" placeholder="House #" autocomplete="off" required>
      <input id="delstreet" title="Street Name" name="delstreet" type="text" size="20" placeholder="Street Name" autocomplete="off" required>
      <input id="delunit" title="Apt. or Unit #" name="delunit" type="text" size="8" placeholder="Apt #" autocomplete="off">
      <input id="delcity" title="City" name="delcity" type='text' size='16' placeholder='City', autocomplete='off'>
      <input id="delzipcode" title="Zip Code" name="delzipcode" type='text' size='11', placeholder='Zip Code' autocomplete='off' >
    </div>
    <div>
    <label for="group">Group or organization you are with (if any):</label>
	<input id="group" title="Group or Organizaton you're with" name="group" type="text" size="50" placeholder="Group or Organization Name">
	</div>
  </fieldset>
  <br>
  <div>
  	<span id="errormessage">Please ensure all fields are complete before submitting</span>
  	<span id="submitspan">
  	  <input id="btnsubmit" type="button" value="Submit Registration to ONC" style="background-color: #336699; color: #ffffff;" title="Click to sumbit to ONC" onclick= submitRegistration()>
  	</span>
  </div>
</form>
 <!-- Success Dialog -->
  <div id="registereddlg" class="modalDialog">
	<div id='inner'>
	<a id='closepopup' href="#close" title="Close" class="close" onclick="onCloseDialog()"></a>
		<div id='dialogtopbar'>
		  <img src="onclogo" height="45" width="65"/>
		  <span id='dialogmssg'>You're Registered!</span>
		</div>
		<p id='success_mssg'>SUCCESS_MSSG</p>
    	<div id='buttonbar'>
      	  <button id="btnsuccess" onclick="onCloseDialog()">Close</button>
    	</div> 
	</div>
  </div>    
</body>
</html>   